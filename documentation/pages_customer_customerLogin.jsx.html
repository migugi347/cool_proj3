<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/customer/customerLogin.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/customer/customerLogin.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// import React, { useEffect, useState } from "react"
// import { useNavigate } from "react-router-dom"
// import { Form, Button } from "react-bootstrap";
// import axios from "axios";
// import { Link } from 'react-router-dom'
// import jwt_decode from "jwt-decode";
// import Mainlayout from "../../layouts/Mainlayout";
// import { API_URL } from "../../API";





// export default function CustomerLogin(props) {



//     const [authMode, setAuthMode] = useState("signin");
//     const [email, setEmail] = useState("");
//     const [account, setAccount] = useState([]);

//     const navigate = useNavigate();



//     useEffect(() => {
//         (async () => {
//             try {
//                 axios.get(API_URL + "/getAccountType", { params: { email: email } }).then((response) => {
//                     setAccount(response.data);
//                 });
//             } catch (error) {
//                 console.log('error');
//             }
//         })();
//     }, [email]);

//     useEffect(() => {
//         /* global google  */
//         google.accounts.id.initialize({
//             client_id: "704019936455-s2sdsnf3jc47qljoduocgo6ufla51qbn.apps.googleusercontent.com",
//             callback: handleCallbackResponse


//         });
//         google.accounts.id.renderButton(
//             document.getElementById("signInDiv"),
//             {
//                 theme: "outline",
//                 width: 300,
//                 size: "large"
//             }
//         );



//         function handleCallbackResponse(response) {

//             var userObject = jwt_decode(response.credential);
//             console.log(userObject.name);

//             setEmail(userObject.email);
//             setAccount(userObject);

//             localStorage.setItem('user', JSON.stringify(userObject));

//             navigate("/home", { replace: true });
//         }

//     }, [navigate]);

//     const onSubmitHandler = (e) => {
//         e.preventDefault();
//         if (account.length === 0)
//             switchLogin();
//         else if (account[0].type === "manager")
//             navigate("/menu", { replace: true });
//         else if (account[0].type === "server")
//             navigate("/server", { replace: true });
//         else
//             navigate("/home", { replace: true });
//     };

//     const switchLogin = () => {
//         setAuthMode(authMode === "signin" ? "signup" : "signin")
//     }


//     if (authMode === "signin") {
//         return (
//             &lt;Mainlayout className=" align-items-center   ">

//                 &lt;div className="login-form-cont " >

//                     &lt;Form className="login-form " onSubmit={onSubmitHandler}>
//                         &lt;div className="login-form-content">
//                             &lt;h3 >Log In&lt;/h3>

//                             &lt;div className="form-group mt-3">
//                                 &lt;label>Email address&lt;/label>
//                                 &lt;input
//                                     type="email"
//                                     className="form-control mt-1"
//                                     placeholder="name@email.com"
//                                     onChange={(e) => { setEmail("" + e.target.value); }}
//                                     required
//                                 />
//                             &lt;/div>
//                             &lt;div className="form-group mt-3 ">
//                                 &lt;label>Password&lt;/label>
//                                 &lt;input
//                                     type="password"
//                                     className="form-control mt-1"
//                                     placeholder="Password"
//                                     required
//                                 />
//                             &lt;/div>
//                             &lt;div className="d-grid gap-2 mt-3">
//                                 &lt;Button size="md" className="d-grid gap-2 mt-4 mb-2 btn-block bg-primary text-white" type="submit" style={{ fontWeight: 800 }}>
//                                     SUBMIT
//                                 &lt;/Button>
//                                 &lt;div id="signInDiv" >&lt;/div>
//                                 &lt;Link to='/home' className='btn btn-primary'> START ORDER&lt;/Link>
//                             &lt;/div>
//                             &lt;div className="text-center">
//                                 Dont Have an Account?{" "}
//                                 &lt;span className="link-primary" onClick={switchLogin}>
//                                     Sign Up
//                                 &lt;/span>
//                             &lt;/div>


//                         &lt;/div>
//                     &lt;/Form>
//                 &lt;/div>

//             &lt;/Mainlayout>
//         )
//     }

//     return (
//         &lt;Mainlayout>

//             &lt;div className="login-form-cont" >
//                 &lt;script src="https://accounts.google.com/gsi/client" async defer>&lt;/script>

//                 &lt;Form className="auth-form" onSubmit={onSubmitHandler}>
//                     &lt;div className="auth-form-content">
//                         &lt;h3 >Sign Up&lt;/h3>

//                         &lt;div className="form-group mt-3">
//                             &lt;label>Full Name&lt;/label>
//                             &lt;input
//                                 className="form-control mt-1"
//                                 placeholder="First and Last Name"
//                                 required
//                             />
//                         &lt;/div>
//                         &lt;div className="form-group mt-3">
//                             &lt;label>Email address&lt;/label>
//                             &lt;input
//                                 type="email"
//                                 className="form-control mt-1"
//                                 placeholder="name@email.com"
//                                 required
//                             />
//                         &lt;/div>
//                         &lt;div className="form-group mt-3 text-le">
//                             &lt;label>Password&lt;/label>
//                             &lt;input
//                                 type="password"
//                                 className="form-control mt-1"
//                                 placeholder="Password"
//                                 required
//                             />
//                         &lt;/div>
//                         &lt;div className="d-grid gap-2 mt-3">
//                             &lt;Button size="md" className="d-grid gap-2 mt-4 mb-3 btn-block bg-primary text-white" type="submit" style={{ fontWeight: 800 }}>
//                                 SIGN IN
//                             &lt;/Button>
//                         &lt;/div>

//                         &lt;div className="text-center">
//                             Already Have an Account?{" "}
//                             &lt;span className="link-primary" onClick={switchLogin}>
//                                 Sign In
//                             &lt;/span>
//                         &lt;/div>
//                     &lt;/div>
//                 &lt;/Form>
//             &lt;/div>
//         &lt;/Mainlayout>
//     )
// }
import React, { useEffect, useState } from "react"
import { useNavigate } from "react-router-dom"
import { Form, Button } from "react-bootstrap";
import axios from "axios";
import { Link } from 'react-router-dom'
import jwt_decode from "jwt-decode";
import Mainlayout from "../../layouts/Mainlayout";
import { API_URL } from "../../API";


/**
 * Displays the login page for the web application. Furthermore, allows users
 * to login in using OAUTH login or a regular account (using email and password). Also, allows
 * users to create an account if necessary and allows managers and servers
 * to login into their respective systems. All account information is stored in the
 * system's database.
 * @param {HTML} props - elements to be displayed by the login page
 * @returns {HTML} - code displaying the login page
 */
function CustomerLogin(props) {



    const [authMode, setAuthMode] = useState("signin");
    const [email, setEmail] = useState("");
    const [account, setAccount] = useState([]);

    const navigate = useNavigate();

    const [upemail, setUpEmail] = useState("");
    const [upname, setUpName] = useState("");
    const [uppass, setUpPass] = useState("");
    const [tempname,setTempName] = useState("");

    useEffect(() => {
        (async () => {
            try {
                axios.get(API_URL + "/getAccountType", { params: { email: email } }).then((response) => {
                    setAccount(response.data[0].type);
                    setTempName(response.data[0].name);
                    //console.log(tempname);
                });
            } catch (error) {
                console.log('error');
            }
        })();
    }, [email]);

    useEffect(() => {
        /* global google  */
        google.accounts.id.initialize({
            client_id: "704019936455-s2sdsnf3jc47qljoduocgo6ufla51qbn.apps.googleusercontent.com",
            callback: handleCallbackResponse


        });
        google.accounts.id.renderButton(
            document.getElementById("signInDiv"),
            {
                theme: "outline",
                width: 300,
                size: "large"
            }
        );

        function handleCallbackResponse(response) {

            var userObject = jwt_decode(response.credential);
            console.log(userObject.name);

            setEmail(userObject.email);
            setAccount(userObject);

            localStorage.setItem('user', JSON.stringify(userObject));
            localStorage.setItem('name',userObject.name);

            navigate("/home", { replace: true });
        }

    }, [navigate]);

    const onSubmitHandler = (e) => {
        e.preventDefault();
        localStorage.setItem('name',tempname);
        localStorage.setItem('user',JSON.stringify(tempname));
        if (account.length === 0)
            switchLogin();
        else if (account === "manager")
            navigate("/menu", { replace: true });
        else if (account === "server")
            navigate("/server", { replace: true });
        else
            navigate("/home", { replace: true });
    };

    const switchLogin = () => {
        setAuthMode(authMode === "signin" ? "signup" : "signin")
    }

    const signUp = () => {
        axios.post("http://localhost:3001/signup",{
            upname: upname,
            upemail: upemail,
            uppass: uppass
        }); 
    }


    if (authMode === "signin") {
        return (
            &lt;Mainlayout className=" align-items-center   ">

                &lt;script src="https://accounts.google.com/gsi/client" async defer>&lt;/script>
               

                &lt;div className="login-form-cont " style={{backgroundColor:'white'}}>


                    &lt;Form className="login-form " onSubmit={onSubmitHandler}>
                        &lt;div className="login-form-content">
                            &lt;h3 >Log In&lt;/h3>

                            &lt;div className="form-group mt-3">
                                &lt;label>Email address&lt;/label>
                                &lt;input
                                    type="email"
                                    className="form-control mt-1"
                                    placeholder="name@email.com"
                                    onChange={(e) => { setEmail("" + e.target.value); }}
                                    required
                                />
                            &lt;/div>
                            &lt;div className="form-group mt-3 ">
                                &lt;label>Password&lt;/label>
                                &lt;input
                                    type="password"
                                    className="form-control mt-1"
                                    placeholder="Password"
                                    required
                                />
                            &lt;/div>
                            &lt;div className="d-grid gap-2 mt-3">
                                &lt;Button size="md" className="d-grid gap-2 mt-4 mb-2 btn-block text-white" type="submit" style={{ fontWeight: 800,backgroundColor:'var(--primary)'}}>
                                    SUBMIT
                                &lt;/Button>
                                &lt;div id="signInDiv" >&lt;/div>
                            &lt;/div>
                            &lt;div className="text-center">
                                Dont Have an Account?{" "}
                                &lt;span className="link-primary" onClick={switchLogin}>
                                    Sign Up
                                &lt;/span>
                            &lt;/div>


                        &lt;/div>
                    &lt;/Form>
                &lt;/div>

            &lt;/Mainlayout>
        )
    }

    return (
        &lt;Mainlayout>

            &lt;div className="login-form-cont"  style={{backgroundColor:'white'}}>

                &lt;Form className="auth-form" onSubmit={onSubmitHandler}>
                    &lt;div className="auth-form-content">
                        &lt;h3 >Sign Up&lt;/h3>

                        &lt;div className="form-group mt-3">
                            &lt;label>Full Name&lt;/label>
                            &lt;input
                                className="form-control mt-1"
                                placeholder="First and Last Name"
                                required
                                onChange = {(e)=>{setUpName(e.target.value);}}
                            />
                        &lt;/div>
                        &lt;div className="form-group mt-3">
                            &lt;label>Email address&lt;/label>
                            &lt;input
                                type="email"
                                className="form-control mt-1"
                                placeholder="name@email.com"
                                required
                                onChange = {(e)=>{setUpEmail(e.target.value);}}
                            />
                        &lt;/div>
                        &lt;div className="form-group mt-3 text-le">
                            &lt;label>Password&lt;/label>
                            &lt;input
                                type="password"
                                className="form-control mt-1"
                                placeholder="Password"
                                required
                                onChange = {(e)=>{setUpPass(e.target.value);}}
                            />
                        &lt;/div>
                        &lt;div className="d-grid gap-2 mt-3">
                            &lt;Button onClick={()=>signUp()} size="md" className="d-grid gap-2 mt-4 mb-3 btn-block bg-primary text-white" type="submit" style={{ fontWeight: 800 }}>
                                SIGN IN
                            &lt;/Button>
                        &lt;/div>

                        &lt;div className="text-center">
                            Already Have an Account?{" "}
                            &lt;span className="link-primary" onClick={switchLogin}>
                                Sign In
                            &lt;/span>
                        &lt;/div>
                    &lt;/div>
                &lt;/Form>
            &lt;/div>
        &lt;/Mainlayout>
    )
}
export default CustomerLogin</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Mappage.html">Mappage</a></li></ul><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#CancelPopUp">CancelPopUp</a></li><li><a href="global.html#CustomerLogin">CustomerLogin</a></li><li><a href="global.html#Employees">Employees</a></li><li><a href="global.html#ExReports">ExReports</a></li><li><a href="global.html#Inventory">Inventory</a></li><li><a href="global.html#Mainlayout">Mainlayout</a></li><li><a href="global.html#Menu">Menu</a></li><li><a href="global.html#Orders">Orders</a></li><li><a href="global.html#PopUp">PopUp</a></li><li><a href="global.html#Pospage">Pospage</a></li><li><a href="global.html#ReReports">ReReports</a></li><li><a href="global.html#Reports">Reports</a></li><li><a href="global.html#Server_homescreen">Server_homescreen</a></li><li><a href="global.html#SubmitPopUp">SubmitPopUp</a></li><li><a href="global.html#UpdateInventory">UpdateInventory</a></li><li><a href="global.html#UpdateMenu">UpdateMenu</a></li><li><a href="global.html#homepage">homepage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Tue Dec 06 2022 19:21:08 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
